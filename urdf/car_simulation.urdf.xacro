<?xml version="1.0" encoding="utf-8"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="car_simulation">
<!--  -->
  <xacro:property name="base_link_msh" value="package://car_simulation/meshes/base_link.STL" />
  <xacro:property name="LB_wheel_msh" value="package://car_simulation/meshes/LB_wheel.STL" />
  <xacro:property name="LF_wheel_msh" value="package://car_simulation/meshes/LF_wheel.STL" />
  <xacro:property name="RB_wheel_msh" value="package://car_simulation/meshes/RB_wheel.STL" />
  <xacro:property name="RF_wheel_msh" value="package://car_simulation/meshes/RF_wheel.STL" />
<!--  -->
  <gazebo>
    <plugin
      name="gazebo_ros_control"
      filename="libgazebo_ros_control.so">
      <robotNamespace>/</robotNamespace>
    </plugin>
  </gazebo>
  <gazebo>
    <plugin name="skid_steer_drive_controller" filename="libgazebo_ros_skid_steer_drive.so">
      <legacyMode>false</legacyMode>
      <alwaysOn>true</alwaysOn>
      <updateRate>100.0</updateRate>
      <robotNamespace>/</robotNamespace>
      <leftFrontJoint>LF_wheel</leftFrontJoint>
      <rightFrontJoint>RF_wheel</rightFrontJoint>
      <leftRearJoint>LB_wheel</leftRearJoint>
      <rightRearJoint>RB_wheel</rightRearJoint>
      <wheelSeparation>0.4</wheelSeparation>
      <wheelDiameter>0.215</wheelDiameter>
      <robotBaseFrame>base_link</robotBaseFrame>
      <torque>10</torque>
      <topicName>cmd_vel</topicName>
      <broadcastTF>false</broadcastTF>
    </plugin>
  </gazebo>
  <!--  -->
  <link name="dummy"></link>
  <joint name="dummy_joint" type="fixed">
    <parent link="dummy"/>
    <child link="base_link"/>
  </joint>
  <!--  -->
  <xacro:macro name="links" params="part xyz_lnk ixx ixy ixz iyy iyz izz">
    <gazebo reference="${part}">
      <material>Gazebo/Orange</material>
    </gazebo>
    <link
      name="${part}">
      <inertial>
        <origin
          xyz="${xyz_lnk}"
          rpy="0 0 0" />
        <mass
          value="${mass}" />
        <inertia ixx="${ixx}" ixy="${ixy}" ixz="${ixz}" 
                 iyy="${iyy}" iyz="${iyz}" izz="${izz}" />
      </inertial>
      <visual>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="${${part}_msh}" />
        </geometry>
        <material
          name="">
          <color
            rgba="0.79216 0.81961 0.93333 1" />
        </material>
      </visual>
      <collision>
        <origin
          xyz="0 0 0"
          rpy="0 0 0" />
        <geometry>
          <mesh
            filename="${${part}_msh}" />
        </geometry>
      </collision>
    </link>
  </xacro:macro>
  <!--  -->
  <xacro:macro name="joints" params="part xyz_jnt x_axs">
    <joint
      name="${part}_jnt"
      type="continuous">
      <origin
        xyz="${xyz_jnt}"
        rpy="0 0 0" />
      <parent
        link="base_link" />
      <child
        link="${part}"/>
      <axis
        xyz="${x_axs} 0 0" />
      <limit
        effort="0"
        velocity="35" />
    </joint>
  </xacro:macro>
  <!--  -->
  <xacro:links  part="base_link" mass="8"
                xyz_lnk="-0.00074513 -0.11739 0.055785" 
                ixx="0.55567" ixy="-0.00039063" ixz="-0.0032652"
                iyy="0.57391" iyz="-0.019683" izz="0.61063"/>
  <!--  -->
  <xacro:links  part="LF_wheel" mass="0.49554"
                xyz_lnk="-0.032026 -1.3878E-17 -5.5511E-17" 
                ixx="0.0018121" ixy="2.1263E-22" ixz="1.9263E-20" 
                iyy="0.00096656" iyz="5.0211E-21" izz="0.00096656"/>
  <xacro:joints part="LF_wheel" xyz_jnt="-0.27192 0.1695 -0.1241" x_axs="1"/>
  <!--  -->
  <xacro:links  part="LB_wheel" mass="0.49554"
                xyz_lnk="-0.032026 2.7756E-17 2.7756E-17" 
                ixx="0.0018121" ixy="2.1243E-20" ixz="3.9097E-21"
                iyy="0.00096656" iyz="9.7862E-20" izz="0.00096656"/>
  <xacro:joints part="LB_wheel" xyz_jnt="-0.27192 -0.2695 -0.1241" x_axs="1"/>
  <!--  -->
  <xacro:links part="RF_wheel" mass="0.49554"
                xyz_lnk="0.032026 6.9389E-17 0" 
                xyz_jnt="0.27208 0.1695 -0.1241"
                ixx="0.0018121" ixy="1.1755E-35" ixz="2.5636E-20"
                iyy="0.00096656" iyz="3.8844E-35" izz="0.00096656"/>
  <xacro:joints part="RF_wheel" xyz_jnt="0.27208 0.1695 -0.1241" x_axs="-1"/>
  <!--  -->
  <xacro:links  part="RB_wheel" mass="0.49554"
                xyz_jnt="0.27208 -0.2695 -0.1241"
                ixx="0.0018121" ixy="3.3987E-36" ixz="1.3212E-20"
                iyy="0.00096656" iyz="-4.9432E-36" izz="0.00096656"/>          
  <xacro:joints part="RB_wheel" xyz_jnt="0.27208 -0.2695 -0.1241" x_axs="-1"/>                                                          
</robot>